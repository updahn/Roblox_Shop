-- ä¼šå‘˜ç®¡ç†ç•Œé¢æ¨¡å— - é€‚é…å™¨æ¨¡å¼
-- ç°åœ¨ä½¿ç”¨ç»Ÿä¸€çš„ShopAdminPanel

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- ç­‰å¾…å…±äº«æ¨¡å—
local SharedModules = ReplicatedStorage:WaitForChild("SharedModules")
local Config = require(SharedModules:WaitForChild("Config"))

-- å¯¼å…¥ç»Ÿä¸€çš„ç®¡ç†é¢æ¿
local ShopAdminPanel = require(game:GetService("StarterPlayer").StarterPlayerScripts.Client.ui:WaitForChild("ShopAdminPanel"))

local player = Players.LocalPlayer

local ShopMembership = {}

-- æ˜¾ç¤ºä¼šå‘˜ç®¡ç†ç•Œé¢ - ç°åœ¨ç›´æ¥è°ƒç”¨ç»Ÿä¸€é¢æ¿
function ShopMembership.showMembershipUI(screenGui)
    print("ğŸ‘¥ [ä¼šå‘˜ç®¡ç†é€‚é…å™¨] è°ƒç”¨ç»Ÿä¸€ç®¡ç†é¢æ¿")

    -- æ£€æŸ¥ç®¡ç†å‘˜æƒé™ - ä½¿ç”¨AdminController
    local isAdmin = false
    local success, AdminController = pcall(function()
        local Players = game:GetService("Players")
        local StarterPlayer = game:GetService("StarterPlayer")
        return require(StarterPlayer.StarterPlayerScripts.Client.controller.AdminController)
    end)

    if success and AdminController then
        local adminCheckSuccess, adminResult = pcall(function()
            return AdminController.checkPermission()
        end)
        if adminCheckSuccess then
            isAdmin = adminResult
        end
    end

    if not isAdmin then
        print("âŒ [ä¼šå‘˜ç®¡ç†é€‚é…å™¨] ç®¡ç†å‘˜æƒé™æ£€æŸ¥å¤±è´¥")
        return
    end

    -- ç›´æ¥è°ƒç”¨ç»Ÿä¸€çš„ç®¡ç†é¢æ¿ï¼Œå¹¶åˆ‡æ¢åˆ°ä¼šå‘˜ç®¡ç†æ ‡ç­¾
    ShopAdminPanel.showAdminPanel(screenGui, function(message, isSuccess)
        print("ğŸ“ [ä¼šå‘˜ç®¡ç†] é€šçŸ¥:", message)
    end)

    -- å»¶è¿Ÿåˆ‡æ¢åˆ°ä¼šå‘˜ç®¡ç†æ ‡ç­¾
    task.wait(0.1)
    ShopAdminPanel.switchTab("membership")
end

-- å…¶ä»–å‡½æ•°ä¿æŒå­˜åœ¨ä»¥ä¿è¯å‘åå…¼å®¹æ€§ï¼Œä½†é‡å®šå‘åˆ°ç»Ÿä¸€é¢æ¿
function ShopMembership.createMembershipUI()
    print("âš ï¸ [åºŸå¼ƒå‡½æ•°] createMembershipUI è¢«è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ç»Ÿä¸€ç®¡ç†é¢æ¿")
    return nil
end

function ShopMembership.hideMembershipUI()
    print("âš ï¸ [åºŸå¼ƒå‡½æ•°] hideMembershipUI è¢«è°ƒç”¨")
end

function ShopMembership.refreshMembershipData()
    print("âš ï¸ [åºŸå¼ƒå‡½æ•°] refreshMembershipData è¢«è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ç»Ÿä¸€ç®¡ç†é¢æ¿")
end

function ShopMembership.updateMembershipList()
    print("âš ï¸ [åºŸå¼ƒå‡½æ•°] updateMembershipList è¢«è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ç»Ÿä¸€ç®¡ç†é¢æ¿")
end

print("ğŸ‘¥ ä¼šå‘˜ç®¡ç†é€‚é…å™¨æ¨¡å—å·²åŠ è½½")

return ShopMembership
