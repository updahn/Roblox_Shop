-- å•†åº—UIç³»ç»Ÿä¸»æ–‡ä»¶ - æ¨¡å—åŒ–æ¶æ„

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- ç­‰å¾…å…±äº«æ¨¡å—
local SharedModules = ReplicatedStorage:WaitForChild("SharedModules")
local ShopData = require(SharedModules:WaitForChild("ShopData"))
local ShopEvents = require(SharedModules:WaitForChild("ShopEvents"))

-- å¯¼å…¥æ‹†åˆ†çš„æ¨¡å—
local ShopUtils = require(script.Parent:WaitForChild("ShopUtils"))
local ShopBuy = require(script.Parent:WaitForChild("ShopBuy"))
local ShopSell = require(script.Parent:WaitForChild("ShopSell"))
local ShopRecords = require(script.Parent:WaitForChild("ShopRecords"))
local ShopAdmin = require(script.Parent:WaitForChild("ShopAdmin"))

local ShopUI = {}
ShopUI.__index = ShopUI

-- UIçŠ¶æ€
local currentTab = "buy" -- "buy", "sell", "records"
local playerData = nil
local shopData = nil -- å­˜å‚¨ä»æœåŠ¡å™¨è·å–çš„å•†åº—æ•°æ®ï¼ˆåŒ…å«å®æ—¶åº“å­˜ï¼‰
local isShopOpen = false

-- UIå…ƒç´ 
local screenGui = nil
local mainFrame = nil
local coinLabel = nil
local tabButtons = {}
local contentFrame = nil
local scrollFrame = nil
local titleLabel = nil

-- åˆ›å»ºæ•°é‡é€‰æ‹©å¯¹è¯æ¡†
function ShopUI.showQuantityDialog(itemId, action)
    local item = ShopData.SHOP_ITEMS[itemId]
    if not item then return end

    -- åˆ›å»ºå¯¹è¯æ¡†èƒŒæ™¯
    local dialogBg = Instance.new("Frame")
    dialogBg.Name = "QuantityDialogBg"
    dialogBg.Size = UDim2.new(1, 0, 1, 0)
    dialogBg.Position = UDim2.new(0, 0, 0, 0)
    dialogBg.BackgroundColor3 = ShopUtils.COLORS.OVERLAY
    dialogBg.BackgroundTransparency = 0.5
    dialogBg.BorderSizePixel = 0
    dialogBg.ZIndex = 1000
    dialogBg.Parent = screenGui

    -- å¯¹è¯æ¡†ä¸»ä½“
    local dialog = Instance.new("Frame")
    dialog.Name = "QuantityDialog"
    dialog.Size = UDim2.new(0, 400, 0, 300)
    dialog.Position = UDim2.new(0.5, -200, 0.5, -150)
    dialog.BackgroundColor3 = ShopUtils.COLORS.PRIMARY
    dialog.BorderSizePixel = 0
    dialog.ZIndex = 1001
    dialog.Parent = dialogBg

    ShopUtils.createCorner(dialog, 16)

    -- æ¯›ç»ç’ƒæ•ˆæœ
    local glassBg = Instance.new("Frame")
    glassBg.Size = UDim2.new(1, 0, 1, 0)
    glassBg.BackgroundColor3 = ShopUtils.COLORS.GLASS_BG
    glassBg.BackgroundTransparency = 0.2
    glassBg.BorderSizePixel = 0
    glassBg.ZIndex = 1001
    glassBg.Parent = dialog
    ShopUtils.createCorner(glassBg, 16)

    -- æ ‡é¢˜
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Text = action == "buy" and "è´­ä¹°å•†å“" or "å–å‡ºå•†å“"
    title.Font = Enum.Font.SourceSansBold
    title.TextSize = 24
    title.TextColor3 = ShopUtils.COLORS.TEXT_PRIMARY
    title.Size = UDim2.new(1, -40, 0, 50)
    title.Position = UDim2.new(0, 20, 0, 20)
    title.BackgroundTransparency = 1
    title.ZIndex = 1002
    title.Parent = dialog

    -- å•†å“ä¿¡æ¯
    local itemInfo = Instance.new("TextLabel")
    itemInfo.Text = "ğŸ“¦ " .. item.name .. "\nğŸ’° " .. (action == "buy" and item.price or math.floor(item.price * 0.8)) .. " é‡‘å¸/ä¸ª"
    itemInfo.Font = Enum.Font.SourceSans
    itemInfo.TextSize = 16
    itemInfo.TextColor3 = ShopUtils.COLORS.TEXT_SECONDARY
    itemInfo.Size = UDim2.new(1, -40, 0, 50)
    itemInfo.Position = UDim2.new(0, 20, 0, 80)
    itemInfo.BackgroundTransparency = 1
    itemInfo.ZIndex = 1002
    itemInfo.Parent = dialog

    -- æ•°é‡æ§åˆ¶åŒºåŸŸ
    local quantityFrame = Instance.new("Frame")
    quantityFrame.Size = UDim2.new(0, 200, 0, 60)
    quantityFrame.Position = UDim2.new(0.5, -100, 0, 140)
    quantityFrame.BackgroundTransparency = 1
    quantityFrame.ZIndex = 1002
    quantityFrame.Parent = dialog

    -- å‡å°‘æŒ‰é’®
    local minusButton = ShopUtils.createButton("-", ShopUtils.COLORS.ERROR, quantityFrame, nil)
    minusButton.Size = UDim2.new(0, 50, 0, 50)
    minusButton.Position = UDim2.new(0, 0, 0, 0)
    minusButton.TextSize = 24
    minusButton.ZIndex = 1002

    -- æ•°é‡è¾“å…¥æ¡†
    local quantityBox = Instance.new("TextBox")
    quantityBox.Name = "QuantityBox"
    quantityBox.Text = "1"
    quantityBox.Font = Enum.Font.SourceSansBold
    quantityBox.TextSize = 20
    quantityBox.TextColor3 = ShopUtils.COLORS.TEXT_PRIMARY
    quantityBox.BackgroundColor3 = ShopUtils.COLORS.SECONDARY
    quantityBox.BorderSizePixel = 0
    quantityBox.Size = UDim2.new(0, 100, 0, 50)
    quantityBox.Position = UDim2.new(0, 50, 0, 0)
    quantityBox.PlaceholderText = "æ•°é‡"
    quantityBox.ZIndex = 1002
    quantityBox.Parent = quantityFrame

    ShopUtils.createCorner(quantityBox, 8)

    -- å¢åŠ æŒ‰é’®
    local plusButton = ShopUtils.createButton("+", ShopUtils.COLORS.SUCCESS, quantityFrame, nil)
    plusButton.Size = UDim2.new(0, 50, 0, 50)
    plusButton.Position = UDim2.new(0, 150, 0, 0)
    plusButton.TextSize = 24
    plusButton.ZIndex = 1002

    -- æ•°é‡æ§åˆ¶é€»è¾‘
    local currentQuantity = 1
    local maxQuantity

    if action == "buy" then
        -- è´­ä¹°æ—¶çš„æœ€å¤§æ•°é‡é™åˆ¶
        if shopData and shopData[itemId] and shopData[itemId].currentStock ~= nil then
            maxQuantity = shopData[itemId].currentStock == -1 and 999 or shopData[itemId].currentStock
        elseif item.maxQuantity ~= nil then
            maxQuantity = item.maxQuantity == -1 and 999 or item.maxQuantity
        else
            maxQuantity = 999
        end
    else
        -- å–å‡ºæ—¶çš„æœ€å¤§æ•°é‡é™åˆ¶ï¼ˆç©å®¶æ‹¥æœ‰çš„æ•°é‡ï¼‰
        maxQuantity = (playerData and playerData.inventory[itemId]) or 0
    end

    local function updateQuantity(newQuantity)
        currentQuantity = math.max(1, math.min(maxQuantity, newQuantity))
        quantityBox.Text = tostring(currentQuantity)

        local totalPrice = currentQuantity * (action == "buy" and item.price or math.floor(item.price * 0.8))
        itemInfo.Text = "ğŸ“¦ " .. item.name .. "\nğŸ’° æ€»è®¡: " .. totalPrice .. " é‡‘å¸"
    end

    minusButton.MouseButton1Click:Connect(function()
        updateQuantity(currentQuantity - 1)
    end)

    plusButton.MouseButton1Click:Connect(function()
        updateQuantity(currentQuantity + 1)
    end)

    quantityBox.FocusLost:Connect(function()
        local newQuantity = tonumber(quantityBox.Text) or 1
        updateQuantity(newQuantity)
    end)

    -- æŒ‰é’®åŒºåŸŸ
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Size = UDim2.new(1, -40, 0, 50)
    buttonFrame.Position = UDim2.new(0, 20, 0, 220)
    buttonFrame.BackgroundTransparency = 1
    buttonFrame.ZIndex = 1002
    buttonFrame.Parent = dialog

    -- ç¡®è®¤æŒ‰é’®
    local confirmButton = ShopUtils.createButton("âœ“ ç¡®è®¤", ShopUtils.COLORS.SUCCESS, buttonFrame, function()
        if action == "buy" then
            ShopEvents.RemoteEvents.PurchaseItem:FireServer(itemId, currentQuantity)
        else
            ShopEvents.RemoteEvents.SellItem:FireServer(itemId, currentQuantity)
        end

        dialogBg:Destroy()
    end)
    confirmButton.Position = UDim2.new(0, 0, 0, 0)
    confirmButton.Size = UDim2.new(0, 150, 0, 40)
    confirmButton.ZIndex = 1002

    -- å–æ¶ˆæŒ‰é’®
    local cancelButton = ShopUtils.createButton("âœ— å–æ¶ˆ", ShopUtils.COLORS.ERROR, buttonFrame, function()
        dialogBg:Destroy()
    end)
    cancelButton.Position = UDim2.new(1, -150, 0, 0)
    cancelButton.Size = UDim2.new(0, 150, 0, 40)
    cancelButton.ZIndex = 1002

    -- å¼¹å‡ºåŠ¨ç”»
    dialog.Size = UDim2.new(0, 0, 0, 0)
    dialog.Position = UDim2.new(0.5, 0, 0.5, 0)

    local openTween = TweenService:Create(dialog, TweenInfo.new(0.3, Enum.EasingStyle.Back), {
        Size = UDim2.new(0, 400, 0, 300),
        Position = UDim2.new(0.5, -200, 0.5, -150)
    })
    openTween:Play()

    updateQuantity(1)
end

-- æ›´æ–°UIæ˜¾ç¤º
function ShopUI.updateUI()
    if not screenGui or not mainFrame then return end

    -- æ›´æ–°é‡‘å¸æ˜¾ç¤º
    if coinLabel and playerData then
        coinLabel.Text = "ğŸ’° " .. playerData.coins .. " é‡‘å¸"
    end

    -- æ›´æ–°æ ‡é¢˜
    if titleLabel then
        if currentTab == "buy" then
            titleLabel.Text = "ğŸ›’ å•†åº—è´­ä¹°"
        elseif currentTab == "sell" then
            titleLabel.Text = "ğŸ’° ç‰©å“å–å‡º"
        elseif currentTab == "records" then
            titleLabel.Text = "ğŸ“Š è´­ä¹°è®°å½•"
        end
    end

    -- æ›´æ–°æ ‡ç­¾æŒ‰é’®çŠ¶æ€
    for tabName, button in pairs(tabButtons) do
        if tabName == currentTab then
            button.BackgroundColor3 = ShopUtils.COLORS.ACCENT
            button.TextColor3 = ShopUtils.COLORS.PRIMARY
        else
            button.BackgroundColor3 = ShopUtils.COLORS.SECONDARY
            button.TextColor3 = ShopUtils.COLORS.TEXT_PRIMARY
        end
    end

    -- æ¸…ç©ºæ»šåŠ¨æ¡†å†…å®¹ï¼Œé˜²æ­¢ç•Œé¢å…ƒç´ æ··åˆ
    if scrollFrame then
        for _, child in pairs(scrollFrame:GetChildren()) do
            if child:IsA("Frame") then
                child:Destroy()
            end
        end
    end

    -- æ ¹æ®å½“å‰æ ‡ç­¾é¡µæ˜¾ç¤ºå†…å®¹
    if currentTab == "buy" then
        ShopBuy.showBuyItems(scrollFrame, shopData, playerData, ShopUI.showQuantityDialog)
    elseif currentTab == "sell" then
        ShopSell.showSellItems(scrollFrame, shopData, playerData, ShopUI.showQuantityDialog)
    elseif currentTab == "records" then
        ShopRecords.showPurchaseRecords(scrollFrame, playerData, function()
            ShopAdmin.showAdminPanel(screenGui, function(message, isSuccess)
                ShopUtils.showNotification(message, isSuccess, screenGui)
            end)
        end)
    end
end

-- åˆ›å»ºä¸»ç•Œé¢
function ShopUI.createUI()
    if screenGui then
        screenGui:Destroy()
    end

    -- åˆ›å»ºScreenGui
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "ShopUI"
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.IgnoreGuiInset = false
    screenGui.Parent = playerGui

    -- ä¸»æ¡†æ¶
    mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 850, 0, 650)
    mainFrame.Position = UDim2.new(0.5, -425, 0.5, -325)
    mainFrame.BackgroundColor3 = ShopUtils.COLORS.PRIMARY
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Visible = false
    mainFrame.ClipsDescendants = true
    mainFrame.Parent = screenGui

    ShopUtils.createCorner(mainFrame, 20)

    -- é¡¶éƒ¨æ 
    local topBar = Instance.new("Frame")
    topBar.Name = "TopBar"
    topBar.Size = UDim2.new(1, -4, 0, 90)
    topBar.Position = UDim2.new(0, 2, 0, 2)
    topBar.BackgroundColor3 = ShopUtils.COLORS.SECONDARY
    topBar.BorderSizePixel = 0
    topBar.ClipsDescendants = true
    topBar.Parent = mainFrame

    ShopUtils.createCorner(topBar, 20)

    -- é®ç½©åº•éƒ¨åœ†è§’
    local topBarMask = Instance.new("Frame")
    topBarMask.Size = UDim2.new(1, 0, 0, 20)
    topBarMask.Position = UDim2.new(0, 0, 1, -20)
    topBarMask.BackgroundColor3 = ShopUtils.COLORS.SECONDARY
    topBarMask.BorderSizePixel = 0
    topBarMask.Parent = topBar

    -- æ ‡é¢˜
    titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "TitleLabel"
    titleLabel.Text = "ğŸ›’ å•†åº—è´­ä¹°"
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 28
    titleLabel.TextColor3 = ShopUtils.COLORS.TEXT_PRIMARY
    titleLabel.Size = UDim2.new(0, 350, 0, 90)
    titleLabel.Position = UDim2.new(0, 40, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = topBar

    -- é‡‘å¸æ˜¾ç¤º
    coinLabel = Instance.new("TextLabel")
    coinLabel.Name = "CoinLabel"
    coinLabel.Text = "ğŸ’° åŠ è½½ä¸­..."
    coinLabel.Font = Enum.Font.GothamBold
    coinLabel.TextSize = 16
    coinLabel.TextColor3 = ShopUtils.COLORS.WARNING
    coinLabel.Size = UDim2.new(0, 150, 0, 20)
    coinLabel.Position = UDim2.new(1, -210, 0, 15)
    coinLabel.BackgroundTransparency = 1
    coinLabel.TextXAlignment = Enum.TextXAlignment.Right
    coinLabel.TextTruncate = Enum.TextTruncate.AtEnd
    coinLabel.TextScaled = true
    coinLabel.Parent = topBar

    -- æ ‡ç­¾æŒ‰é’® - ç»Ÿä¸€å¤§å°å’Œä½ç½®
    local tabData = {
        {name = "buy", text = "ğŸ›’ è´­ä¹°", pos = UDim2.new(1, -480, 0, 25)},
        {name = "sell", text = "ğŸ’° å–å‡º", pos = UDim2.new(1, -380, 0, 25)},
        {name = "records", text = "ğŸ“Š è®°å½•", pos = UDim2.new(1, -280, 0, 25)}
    }

    for _, tab in ipairs(tabData) do
        local button = ShopUtils.createButton(tab.text, ShopUtils.COLORS.SECONDARY, topBar, function()
            currentTab = tab.name
            -- åˆ‡æ¢æ ‡ç­¾æ—¶é‡æ–°è·å–æœ€æ–°æ•°æ®
            ShopEvents.RemoteEvents.GetPlayerData:FireServer()
            ShopEvents.RemoteEvents.GetShopData:FireServer()
            ShopUI.updateUI()
        end)
        button.Position = tab.pos
        -- ç»Ÿä¸€æŒ‰é’®å¤§å°
        button.Size = UDim2.new(0, 95, 0, 40)
        button.TextSize = 14
        button.Font = Enum.Font.SourceSansBold
        tabButtons[tab.name] = button
    end

    -- å…³é—­æŒ‰é’®
    local closeButton = ShopUtils.createButton("âœ—", ShopUtils.COLORS.ERROR, topBar, function()
        ShopUI.closeShop()
    end)
    closeButton.Position = UDim2.new(1, -50, 0, 10)
    closeButton.Size = UDim2.new(0, 40, 0, 40)
    closeButton.TextSize = 20

    -- æ»šåŠ¨åŒºåŸŸ
    scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Name = "ScrollFrame"
    scrollFrame.Size = UDim2.new(1, -70, 1, -140)
    scrollFrame.Position = UDim2.new(0, 25, 0, 115)
    scrollFrame.BackgroundColor3 = ShopUtils.COLORS.PRIMARY
    scrollFrame.BackgroundTransparency = 0
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 8
    scrollFrame.ScrollBarImageColor3 = ShopUtils.COLORS.ACCENT
    scrollFrame.ClipsDescendants = true
    scrollFrame.Parent = mainFrame

    -- æ·»åŠ åœ†è§’åˆ°æ»šåŠ¨æ¡†æ¶
    ShopUtils.createCorner(scrollFrame, 12)

    return screenGui
end

-- æ‰“å¼€å•†åº—
function ShopUI.openShop()
    if isShopOpen then return end
    isShopOpen = true

    if not screenGui then
        ShopUI.createUI()
    end

    -- è·å–ç©å®¶æ•°æ®
    ShopEvents.RemoteEvents.GetPlayerData:FireServer()

    mainFrame.Visible = true

    -- å¼€å¯åŠ¨ç”»
    mainFrame.Size = UDim2.new(0, 0, 0, 0)
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.BackgroundTransparency = 1

    local openTween = TweenService:Create(mainFrame,
        TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 850, 0, 650),
        Position = UDim2.new(0.5, -425, 0.5, -325),
        BackgroundTransparency = 0
    })

    -- æ·»åŠ æ—‹è½¬æ•ˆæœ
    local rotationTween = TweenService:Create(mainFrame,
        TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Rotation = 0
    })

    -- è®¾ç½®åˆå§‹æ—‹è½¬
    mainFrame.Rotation = -5

    openTween:Play()
    rotationTween:Play()
end

-- å…³é—­å•†åº—
function ShopUI.closeShop()
    if not isShopOpen then return end
    isShopOpen = false

    if mainFrame then
        -- ç®€åŒ–çš„å…³é—­åŠ¨ç”»ï¼šåªç¼©æ”¾å’Œæ·¡å‡º
        local closeTween = TweenService:Create(mainFrame,
            TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0),
            BackgroundTransparency = 1
        })

        closeTween:Play()

        closeTween.Completed:Connect(function()
            -- ç¡®ä¿ç•Œé¢å®Œå…¨éšè—
            mainFrame.Visible = false

            -- é‡ç½®ä¸»æ¡†æ¶å±æ€§ä¸ºåˆå§‹çŠ¶æ€
            mainFrame.BackgroundTransparency = 0.1
            mainFrame.Size = UDim2.new(0, 850, 0, 650)
            mainFrame.Position = UDim2.new(0.5, -425, 0.5, -325)
            mainFrame.Rotation = 0
        end)
    end

    ShopUtils.SOUNDS.click:Play()
end

-- äº‹ä»¶è¿æ¥
function ShopUI.connectEvents()
    -- è·å–ç©å®¶æ•°æ®å“åº”
    ShopEvents.RemoteEvents.GetPlayerData.OnClientEvent:Connect(function(data)
        playerData = data
        print("âœ… [æ•°æ®åŒæ­¥] ç©å®¶æ•°æ®å·²æ›´æ–° | é‡‘å¸: " .. (data.coins or 0))
        ShopUI.updateUI()
    end)

    -- è·å–å•†åº—æ•°æ®å“åº”
    ShopEvents.RemoteEvents.GetShopData.OnClientEvent:Connect(function(data)
        shopData = data
        local itemCount = 0
        if data then
            for _ in pairs(data) do
                itemCount = itemCount + 1
            end
        end
        print("âœ… [æ•°æ®åŒæ­¥] å•†åº—æ•°æ®å·²æ›´æ–° | å•†å“ç§ç±»: " .. itemCount)
        ShopUI.updateUI()
    end)

    -- è´­ä¹°å“åº”
    ShopEvents.RemoteEvents.PurchaseItem.OnClientEvent:Connect(function(success, message, newData)
        if success then
            playerData = newData
            ShopUI.updateUI()
            ShopUtils.showNotification("âœ… " .. message, true, screenGui)
        else
            ShopUtils.showNotification("âŒ " .. message, false, screenGui)
        end
    end)

    -- å–å‡ºå“åº”
    ShopEvents.RemoteEvents.SellItem.OnClientEvent:Connect(function(success, message, newData)
        if success then
            playerData = newData
            ShopUI.updateUI()
            ShopUtils.showNotification("âœ… " .. message, true, screenGui)
        else
            ShopUtils.showNotification("âŒ " .. message, false, screenGui)
        end
    end)

    -- ç®¡ç†å‘˜åŠŸèƒ½å“åº”
    ShopEvents.RemoteEvents.SetPlayerCoins.OnClientEvent:Connect(function(success, message)
        if success then
            ShopUtils.showNotification("âœ… " .. message, true, screenGui)
        else
            ShopUtils.showNotification("âŒ " .. message, false, screenGui)
        end
    end)

    ShopEvents.RemoteEvents.GetPlayerPurchaseHistory.OnClientEvent:Connect(function(playerName, records, errorMsg)
        if errorMsg then
            ShopUtils.showNotification("âŒ " .. errorMsg, false, screenGui)
        elseif records then
            ShopAdmin.showPlayerRecords(playerName, records, screenGui)
        end
    end)

    -- é”®ç›˜è¾“å…¥
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end

        if input.KeyCode == Enum.KeyCode.E then
            if isShopOpen then
                ShopUI.closeShop()
            else
                ShopUI.openShop()
            end
        end
    end)
end

-- åˆå§‹åŒ–
function ShopUI.init()
    ShopUI.connectEvents()

    -- è¯·æ±‚ç©å®¶æ•°æ®
    if ShopEvents.RemoteEvents.GetPlayerData then
        ShopEvents.RemoteEvents.GetPlayerData:FireServer()
        print("ğŸ“¡ [å®¢æˆ·ç«¯] æ­£åœ¨åŒæ­¥ç©å®¶æ•°æ®...")
    else
        warn("âš ï¸ GetPlayerData è¿œç¨‹äº‹ä»¶æœªæ‰¾åˆ°")
    end

    -- è¯·æ±‚å•†åº—æ•°æ®
    if ShopEvents.RemoteEvents.GetShopData then
        ShopEvents.RemoteEvents.GetShopData:FireServer()
        print("ğŸ“¡ [å®¢æˆ·ç«¯] æ­£åœ¨åŒæ­¥å•†åº—æ•°æ®...")
    else
        warn("âš ï¸ GetShopData è¿œç¨‹äº‹ä»¶æœªæ‰¾åˆ°")
    end

    print("ğŸ¨ [å•†åº—UI] å•†åº—ç³»ç»Ÿå·²å°±ç»ª")
    print("ğŸ”§ [æ§åˆ¶] æŒ‰ E é”®æ‰“å¼€å•†åº—")
end

return ShopUI